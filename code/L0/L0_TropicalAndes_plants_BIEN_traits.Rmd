---
title: "Tropical Andes plant trait data BIEN"
author: "Hazel J. Anderson"
project: "Plant-Frugivore Diversity"
collaborators: "Beth E. Gerstner, Phoebe L. Zarnetske"
overview: "This script retrieves plant trait data from the BIEN database for plant species list."
data input: "none"
data output: "TropicalAndes_BIEN_traits.csv"
date: "2023-07-18"
output: html_document
---

# Set file paths
```{r}
data_path <- file.path('G:/Shared drives/SpaCE_Lab_FRUGIVORIA/data/plants/L0')
output_path <- file.path('G:/Shared drives/SpaCE_Lab_FRUGIVORIA/data/plants/L0')
```

# Load required packages
```{r}
library(BIEN)
library(tidyr)
library(dplyr)
```

```{r}
#filter by species list
TropicalAndes_plant_Forest_SpeciesList <- read.csv("G:/Shared drives/SpaCE_Lab_FRUGIVORIA/data/plants/L1/TropicalAndes_plant_Forest_SpeciesList.csv")
species_list <- TropicalAndes_plant_Forest_SpeciesList$x
```

```{r}
trait_list <- c("whole plant dispersal syndrome", "whole plant height", "maximum whole plant longevity")
TropicalAndes_BIEN_plant_traits_forest <- BIEN_trait_traitbyspecies(species_list, trait_list, all.taxonomy = TRUE, political.boundaries = TRUE, source.citation = TRUE)
```

```{r}
dispersal_mean <- BIEN_trait_mean(species_list, "whole plant dispersal syndrome")
height_mean <- BIEN_trait_mean(species_list, "whole plant height")
longevity_mean <- BIEN_trait_mean(species_list, "maximum whole plant longevity")
```


# Data summary
```{r}
glimpse(TropicalAndes_BIEN_plant_traits_forest)
```

```{r}
print("The number of records is")
nrow(TropicalAndes_BIEN_plant_traits_forest)
print("The number of species is")
length(unique(TropicalAndes_BIEN_plant_traits_forest$scrubbed_species_binomial))
print("The number of families is")
length(unique(TropicalAndes_BIEN_plant_traits_forest$family_matched))
```

```{r}
TropicalAndes_BIEN_plant_traits_forest %>% count(trait_name)
```

# Write data to csv
```{r}
TropicalAndes_BIEN_traits_path <- file.path(output_path,"TropicalAndes_BIEN_plant_traits_forest.csv") 
write.csv(TropicalAndes_BIEN_plant_traits_forest, file = TropicalAndes_BIEN_traits_path)
```